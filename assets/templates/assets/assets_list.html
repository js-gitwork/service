<!DOCTYPE html>
<html>
<head>
    <title>Rediger Aktiver</title>
    <link rel="stylesheet" href="/static/assets/css/assets.css">
</head>
<body>
    <h1>Aktiver</h1>
    <input type="text" id="search" placeholder="Søg efter VPID eller navn..." onkeyup="searchFunction()">

    <table id="assetTable">
        <tr>
            <th>VPID</th>
            <th>Navn</th>
            <th>Kategori</th>
            <th>Status</th>
            <th>Handlinger</th>
        </tr>
        {% for asset in assets %}
        <tr class="{% if not asset.is_active %}inactive{% endif %}" data-id="{{ asset.pk }}">
            <td>{{ asset.VPID }}</td>
            <td>{{ asset.name }}</td>
            <td>{{ asset.category }}</td>
            <td>{% if asset.is_active %}Aktiv{% else %}Udgået{% endif %}</td>
            <td><a href="{% url 'edit_asset' asset.pk %}">Rediger</a></td>
        </tr>
        {% endfor %}
    </table>

    <script>
        // Søgefunktion
        function searchFunction() {
            const input = document.getElementById("search");
            const filter = input.value.toUpperCase();
            const table = document.getElementById("assetTable");
            const rows = table.getElementsByTagName("tr");

            for (let i = 1; i < rows.length; i++) {
                const vpid = rows[i].getElementsByTagName("td")[0];
                const name = rows[i].getElementsByTagName("td")[1];
                if (vpid || name) {
                    const vpidText = vpid.textContent || vpid.innerText;
                    const nameText = name.textContent || name.innerText;
                    if (vpidText.toUpperCase().indexOf(filter) > -1 || nameText.toUpperCase().indexOf(filter) > -1) {
                        rows[i].style.display = "";
                    } else {
                        rows[i].style.display = "none";
                    }
                }
            }
        }

        // Fokuser på række fra URL (f.eks. ?focus=1)
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const focusId = urlParams.get('focus');
           if (focusId) {  // ← Kun kør, hvis der er et ID
            const row = document.querySelector(`tr[data-id="${focusId}"]`);
            if (row) {  // ← Kun kør, hvis rækken findes
                row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                row.classList.add('highlight');
                setTimeout(() => row.classList.remove('highlight'), 3000);
                }
            }
        });
    </script>
</body>
</html>
